{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/santiago.cardenas/Desktop/Proyectos/Proyecto de grado/BurstCar/front/burstCarFront/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"./register.servicio\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../shared/mapa-selector/mapa-selector.component\";\nimport * as i6 from \"@ionic/angular\";\nconst _c0 = [\"mapaRegistro\"];\nfunction RegisterPage_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"h3\");\n    i0.ɵɵtext(2, \"Ubicaci\\u00F3n del prestador\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-item\")(4, \"ion-label\", 20);\n    i0.ɵɵtext(5, \"N\\u00FAmero de v\\u00EDa\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"ion-input\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"ion-item\")(8, \"ion-label\", 20);\n    i0.ɵɵtext(9, \"Direcci\\u00F3n\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"ion-input\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"ion-item\")(12, \"ion-label\", 20);\n    i0.ɵɵtext(13, \"Latitud\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(14, \"ion-input\", 23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"ion-item\")(16, \"ion-label\", 20);\n    i0.ɵɵtext(17, \"Longitud\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"ion-input\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"ion-item\")(20, \"ion-label\", 20);\n    i0.ɵɵtext(21, \"Pa\\u00EDs\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(22, \"ion-input\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"ion-item\")(24, \"ion-label\", 20);\n    i0.ɵɵtext(25, \"Departamento\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(26, \"ion-input\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"ion-item\")(28, \"ion-label\", 20);\n    i0.ɵɵtext(29, \"Ciudad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(30, \"ion-input\", 27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"ion-item\")(32, \"ion-label\", 20);\n    i0.ɵɵtext(33, \"Corregimiento\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(34, \"ion-input\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(35, \"ion-item\")(36, \"ion-label\", 20);\n    i0.ɵɵtext(37, \"Nombre de la v\\u00EDa\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(38, \"ion-input\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(39, \"app-mapa-selector\", 19);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.registroForm.get(\"ubicacion\"));\n    i0.ɵɵadvance(39);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.registroForm.get(\"ubicacion\"));\n  }\n}\nexport let RegisterPage = /*#__PURE__*/(() => {\n  class RegisterPage {\n    constructor(fb, registroServicio, router) {\n      this.fb = fb;\n      this.registroServicio = registroServicio;\n      this.router = router;\n    }\n    ngOnInit() {\n      this.registroForm = this.fb.group({\n        nombre: ['', Validators.required],\n        usuario: ['', Validators.required],\n        contrasena: ['', Validators.required],\n        numeroTelefonico: ['', Validators.required],\n        categoriaIdentificador: ['', Validators.required],\n        numeroIdentificacion: ['', Validators.required],\n        tipoUsuario: ['', Validators.required],\n        ubicacion: this.fb.group({\n          latitud: [''],\n          longitud: [''],\n          nombrePais: [''],\n          nombreDepartamento: [''],\n          nombreCiudad: [''],\n          nombreCorregimiento: [''],\n          nombreVia: [''],\n          numeroVia: [''],\n          direccion: ['']\n        })\n      });\n      this.registroForm.get('tipoUsuario')?.valueChanges.subscribe(valor => {\n        if (valor === 'prestador') {\n          setTimeout(() => {\n            if (this.mapaRegistro) {\n              this.mapaRegistro.redibujarMapa();\n            }\n          }, 300);\n        }\n      });\n    }\n    ngAfterViewInit() {\n      if (this.esPrestador() && this.mapaRegistro) {\n        this.mapaRegistro.redibujarMapa();\n      }\n    }\n    esPrestador() {\n      return this.registroForm.get('tipoUsuario')?.value === 'prestador';\n    }\n    registrar() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const datos = _this.registroForm.value;\n        try {\n          if (datos.tipoUsuario === 'prestador') {\n            const ubicacionRes = yield _this.registroServicio.registrarUbicacion(datos.ubicacion).toPromise();\n            const ubicacionId = ubicacionRes;\n            const datosPrestador = {\n              nombre: datos.nombre,\n              usuario: datos.usuario,\n              contrasena: datos.contrasena,\n              numeroTelefonico: datos.numeroTelefonico,\n              categoriaIdentificador: datos.categoriaIdentificador,\n              numeroIdentificacion: datos.numeroIdentificacion,\n              idUbicacion: ubicacionId\n            };\n            yield _this.registroServicio.registrarPrestador(datosPrestador).toPromise();\n          } else {\n            const datosSolicitante = {\n              nombre: datos.nombre,\n              usuario: datos.usuario,\n              contrasena: datos.contrasena,\n              numeroTelefonico: datos.numeroTelefonico,\n              categoriaIdentificador: datos.categoriaIdentificador,\n              numeroIdentificacion: datos.numeroIdentificacion\n            };\n            yield _this.registroServicio.registrarSolicitante(datosSolicitante).toPromise();\n          }\n          _this.router.navigateByUrl('/login');\n        } catch (error) {\n          console.error('Error al registrar:', error);\n        }\n      })();\n    }\n    static {\n      this.ɵfac = function RegisterPage_Factory(t) {\n        return new (t || RegisterPage)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.RegistroServicio), i0.ɵɵdirectiveInject(i3.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: RegisterPage,\n        selectors: [[\"app-register\"]],\n        viewQuery: function RegisterPage_Query(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵviewQuery(_c0, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.mapaRegistro = _t.first);\n          }\n        },\n        decls: 23,\n        vars: 2,\n        consts: [[1, \"custom-header\"], [\"color\", \"primary\"], [1, \"custom-header-title\"], [1, \"login-background\"], [1, \"login-decor\"], [\"src\", \"../../../assets/img/undraw_vintage_q09n.svg\", \"alt\", \"decoraci\\u00F3n\"], [1, \"login-container\"], [3, \"ngSubmit\", \"formGroup\"], [\"formControlName\", \"nombre\", \"placeholder\", \"Nombre completo\", \"fill\", \"outline\", 1, \"login-input\"], [\"formControlName\", \"usuario\", \"placeholder\", \"Usuario\", \"fill\", \"outline\", 1, \"login-input\"], [\"formControlName\", \"contrasena\", \"type\", \"password\", \"placeholder\", \"Contrase\\u00F1a\", \"fill\", \"outline\", 1, \"login-input\"], [\"formControlName\", \"numeroTelefonico\", \"type\", \"number\", \"placeholder\", \"Tel\\u00E9fono\", \"fill\", \"outline\", 1, \"login-input\"], [\"formControlName\", \"categoriaIdentificador\", \"placeholder\", \"Tipo de ID (ej: CC)\", \"fill\", \"outline\", 1, \"login-input\"], [\"formControlName\", \"numeroIdentificacion\", \"type\", \"text\", \"placeholder\", \"N\\u00FAmero de identificaci\\u00F3n\", \"fill\", \"outline\", 1, \"login-input\"], [\"interface\", \"action-sheet\", \"placeholder\", \"Tipo de usuario\", \"formControlName\", \"tipoUsuario\", 1, \"login-input\"], [\"value\", \"solicitante\"], [\"value\", \"prestador\"], [3, \"formGroup\", 4, \"ngIf\"], [\"expand\", \"block\", \"type\", \"submit\", \"color\", \"dark\", 1, \"login-button\"], [3, \"formGroup\"], [\"position\", \"stacked\"], [\"formControlName\", \"numeroVia\", 1, \"login-input\"], [\"formControlName\", \"direccion\", 1, \"login-input\"], [\"type\", \"number\", \"formControlName\", \"latitud\", 1, \"login-input\"], [\"type\", \"number\", \"formControlName\", \"longitud\", 1, \"login-input\"], [\"formControlName\", \"nombrePais\", 1, \"login-input\"], [\"formControlName\", \"nombreDepartamento\", 1, \"login-input\"], [\"formControlName\", \"nombreCiudad\", 1, \"login-input\"], [\"formControlName\", \"nombreCorregimiento\", 1, \"login-input\"], [\"formControlName\", \"nombreVia\", 1, \"login-input\"]],\n        template: function RegisterPage_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\", 1)(2, \"ion-title\", 2);\n            i0.ɵɵtext(3, \"Crear cuenta\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(4, \"ion-content\", 3)(5, \"div\", 4);\n            i0.ɵɵelement(6, \"img\", 5);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"div\", 6)(8, \"form\", 7);\n            i0.ɵɵlistener(\"ngSubmit\", function RegisterPage_Template_form_ngSubmit_8_listener() {\n              return ctx.registrar();\n            });\n            i0.ɵɵelement(9, \"ion-input\", 8)(10, \"ion-input\", 9)(11, \"ion-input\", 10)(12, \"ion-input\", 11)(13, \"ion-input\", 12)(14, \"ion-input\", 13);\n            i0.ɵɵelementStart(15, \"ion-select\", 14)(16, \"ion-select-option\", 15);\n            i0.ɵɵtext(17, \"Solicitante\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"ion-select-option\", 16);\n            i0.ɵɵtext(19, \"Prestador\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(20, RegisterPage_div_20_Template, 40, 2, \"div\", 17);\n            i0.ɵɵelementStart(21, \"ion-button\", 18);\n            i0.ɵɵtext(22, \" Crear cuenta \");\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"formGroup\", ctx.registroForm);\n            i0.ɵɵadvance(12);\n            i0.ɵɵproperty(\"ngIf\", ctx.esPrestador() && ctx.registroForm.get(\"ubicacion\"));\n          }\n        },\n        dependencies: [i4.NgIf, i1.ɵNgNoValidate, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i5.MapaSelectorComponent, i6.IonButton, i6.IonContent, i6.IonHeader, i6.IonInput, i6.IonItem, i6.IonLabel, i6.IonSelect, i6.IonSelectOption, i6.IonTitle, i6.IonToolbar, i6.NumericValueAccessor, i6.SelectValueAccessor, i6.TextValueAccessor],\n        styles: [\".login-background[_ngcontent-%COMP%]{--background: #2f4f39;min-height:100vh;display:flex;flex-direction:column;align-items:center}.login-decor[_ngcontent-%COMP%]{text-align:center;margin-top:5vh}.login-decor[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:220px;max-width:100%}.login-container[_ngcontent-%COMP%]{width:85%;margin:auto;padding:4vh 0;text-align:center;color:#232020}.login-input[_ngcontent-%COMP%]{margin:12px 0;--background: #f3f3e4;--color: #000;--border-radius: 6px;font-size:15px}.login-button[_ngcontent-%COMP%]{--background: #6c8f6d;--color: white;font-weight:700;margin-top:20px;--border-radius: 8px;transition:transform .2s ease,box-shadow .2s ease}.login-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.login-button[_ngcontent-%COMP%]:active{transform:scale(.97);box-shadow:0 2px 6px #0003}h3[_ngcontent-%COMP%]{margin:24px 0 8px;font-size:1.2rem;color:#f3f3e4;font-weight:700}\"]\n      });\n    }\n  }\n  return RegisterPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}